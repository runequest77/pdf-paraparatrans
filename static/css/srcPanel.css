.paragraph-id {
    color: #888;
    font-weight: bold;
}

.paragraph-struct {
    color: #888;
    font-size: 90%;
}

.paragraph-box {
    display: flex;
    align-items: stretch; /* 子要素の高さを親要素に合わせる */
    position: relative;
    border-bottom: 1px dotted #999;
    position: relative; /* `edit-ui` を正しく配置するために必要 */
    transition: filter 0.1s ease-in-out, outline 0.1s ease-in-out;
    overflow: visible !important; /*edit-uiが他のパラグラフの下に沈んでしまう対策*/
}
.edit-box {
    display: flex;
    position: relative;
    width: 80px;
    border-left: 3px solid #999;
    font-size: initial;
    font-size: 80%;
    padding: 4px;
}
/* 翻訳状態に基づく edit-box の背景色 */
.status-none {
    background-color: var(--dark-red); /* 未翻訳 */
}
.status-auto {
    background-color: var(--dark-blue); /* 自動翻訳 */
}
.status-draft {
    background-color: var(--dark-orange); /* 下訳 */
}
.status-fixed {
    background-color: var(--dark-green); /* 確定 */
}

.paragraph-box.selected {
    outline: 4px solid var(--selection-outline, #3399ff);
    outline-offset: -2px;
    position: relative;
    z-index: 1; /* 他のボックスより前面にくるように */
    overflow: hidden; /* ::after で角がはみ出さないように */
}
/* 選択されたパラグラフに薄黄のマスクを重ねる */
.paragraph-box.selected::after {
    content: "";
    position: absolute;
    inset: 0;
    background-color: rgba(255, 255, 0, 0.2);
    mix-blend-mode: lighten;
    pointer-events: none;
    z-index: 1;
    border-radius: inherit; /* 親の角丸を引き継ぐ！ */
}

.edit-button {
    height: 24px; /* 固定高さ */
    width: 24px; /* 固定幅 */
    visibility: visible; /* 初期状態で表示 */
}

/* ドラッグ用ハンドル */
.drag-handle {
    cursor: move;
    white-space: nowrap;
    flex: 0 0 auto;
    display: flex;
    width: 48px;
    flex-direction: column; /* 子要素を縦に並べる */
    align-items: top;
}
.drag-handle .paragraph-id,
.drag-handle .block-tag {
    display: block; /* ブロック要素として扱う */
    text-align: right; /* 文字を右寄せ */
    margin: 0px;
    line-height: 1; /* 行間を詰める */
    padding: 0; /* パディングをなくす */        
}

.src-html, .src-text, .src-joined, .src-replaced, .trans-auto, .trans-text {
    flex: 1 1 50%;
    word-wrap: break-word;
    padding: 5px;
}
.edit-ui {
    display: none;
    position: absolute;
    top: 100%; /*パラグラフの下にくっつけるように表示*/
    right: 0;
    width: auto;
    border: 4px solid #999;
    padding: 8px 16px 6px 20px;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2); /* 影を追加 */
    white-space: nowrap;
    font-size: 16px;
    line-height: 1.4;
    font-weight: bold;
}
.editing .src-text, .editing .trans-text {
    border: 1px solid #000;
}
.src-text {
    border-left: 4px solid #e74c3c;
}
.src-joined {
    border-left: 4px solid #ffeb3b; /* 黄色系の色 */
}
.src-replaced {
    border-left: 4px solid #3498db;
}
.trans-auto {
    border-left: 4px solid #f39c12;
}
.trans-text {
    border-left: 4px solid #2ecc71;
}
.block-tag-header {
    color: #ccc;
    background-color: #333 !important;
}
.block-tag-footer {
    color: #ccc;
    background-color: #333 !important;
}
.block-tag-remove {
    color: #ccc;
    background-color: #333 !important;
}

/* .block-tag-p {
} */

.block-tag-h1 {
    font-size: 2em; /* 最も大きい見出し */
    font-weight: bold;
    background-color: #2c3e50; /* 濃い青色 */
    color: white;
}

.block-tag-h2 {
    font-size: 1.75em;
    font-weight: bold;
    background-color: #34495e; /* 少し薄い青色 */
    color: white;
}

.block-tag-h3 {
    font-size: 1.5em;
    font-weight: bold;
    text-decoration: underline; /*文字に下線を引く*/
    background-color: #4a69bd; /* 青紫色 */
    color: white;
}

.block-tag-h4 {
    font-size: 1.25em;
    font-weight: bold;
    background-color: #6a89cc; /* 明るい青紫色 */
    color: black;
}

.block-tag-h5 {
    font-size: 1.1em;
    font-weight: bold;
    background-color: #82ccdd; /* 明るい青色 */
    color: black;
}

.block-tag-h6 {
    font-size: 1em; /* 最も小さい見出し */
    font-weight: bold;
    background-color: #b8e994; /* 明るい緑色 */
    color: black;
}

.block-tag-li {
    font-family: monospace;
    font-weight: bold;
    background-color: var(--li-bg);
    color: var(--li-fg);
    border-bottom: var(--li-fg) 3px solid;
}
.block-tag-tr {
    font-family: monospace;
    font-weight: bold;
    background-color: var(--tr-bg);
    color: var(--tr-fg);
    border-bottom: var(--tr-fg) 3px solid;
}


/* 編集状態の背景色と文字色を統一 */
.editing .paragraph-box {
    background-color: #ffffcc; /* 編集時の背景色 */
    color: #333; /* 編集時の文字色 */
}
@media (prefers-color-scheme: dark) {
    .editing .src-text, 
    .editing .trans-text {
        border: 3px solid #000; /* 編集時の枠線 */
        background: #fefbe9; /* 編集時の背景色 */
        color: #000; /* 編集時の文字色 */
    }
    .edit-ui {
        color: #fff; /* 編集時の文字色 */
    }
}
@media (prefers-color-scheme: light) {
    .editing .src-text, 
    .editing .trans-text {
        border: 3px solid #000; /* 編集時の枠線 */
        background: #1e1e1e; /* 編集時の背景色 */
        color: #e0e0e0; /* 編集時の文字色 */
    }
    .edit-ui {
        color: #000; /* 編集時の文字色 */
    }
}

.paragraph-box.current {
    outline: 6px solid #f39c12;
    z-index: 10; /* 他の要素より高い値を指定 */
}

.paragraph-box.highlight {
    position: relative; /* 配置の基準を作る */
    outline: 4px solid #f39c12;
    outline-offset: -4px;
    z-index: 10; /* 他の要素より高い値を指定 */
}


/* ■■■■ 囲み記事 ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */

/* 段落の左に棒を表示するためのインデントと位置設定 */
.paragraph-box.group-start .src-html,
.paragraph-box.group-start .src-text,
.paragraph-box.group-start .src-joined,
.paragraph-box.group-start .src-replaced,
.paragraph-box.group-start .trans-auto,
.paragraph-box.group-start .trans-text,

.paragraph-box.group-middle .src-html,
.paragraph-box.group-middle .src-text,
.paragraph-box.group-middle .src-joined,
.paragraph-box.group-middle .src-replaced,
.paragraph-box.group-middle .trans-auto,
.paragraph-box.group-middle .trans-text,

.paragraph-box.group-end .src-html,
.paragraph-box.group-end .src-text,
.paragraph-box.group-end .src-joined,
.paragraph-box.group-end .src-replaced,
.paragraph-box.group-end .trans-auto,
.paragraph-box.group-end .trans-text {
    padding-left: 32px;     /* 左の棒分の余白 */
    position: relative;     /* ::before 用の基準 */
}

/* 左の棒：共通スタイル（背景色と棒幅） */
.paragraph-box.group-start .src-html::before,
.paragraph-box.group-start .src-text::before,
.paragraph-box.group-start .src-joined::before,
.paragraph-box.group-start .src-replaced::before,
.paragraph-box.group-start .trans-auto::before,
.paragraph-box.group-start .trans-text::before,
.paragraph-box.group-middle .src-html::before,
.paragraph-box.group-middle .src-text::before,
.paragraph-box.group-middle .src-joined::before,
.paragraph-box.group-middle .src-replaced::before,
.paragraph-box.group-middle .trans-auto::before,
.paragraph-box.group-middle .trans-text::before,
.paragraph-box.group-end .src-html::before,
.paragraph-box.group-end .src-text::before,
.paragraph-box.group-end .src-joined::before,
.paragraph-box.group-end .src-replaced::before,
.paragraph-box.group-end .trans-auto::before,
.paragraph-box.group-end .trans-text::before {
    content: "";
    position: absolute;
    top: 0;
    bottom: 0;
    left: 8px;
    width: 16px;
    background-color:rgba(255, 255, 0, 0.4);
    z-index: 0;
}

/* 上1/4円：startのみ上角丸 */
.paragraph-box.group-start .src-html::before,
.paragraph-box.group-start .src-text::before,
.paragraph-box.group-start .src-joined::before,
.paragraph-box.group-start .src-replaced::before,
.paragraph-box.group-start .trans-auto::before,
.paragraph-box.group-start .trans-text::before {
    border-top-left-radius: 9px;
    border-bottom-left-radius: 0;
    top: 8px;
    bottom: 0;
}

/* 直線：middleは角なし */
.paragraph-box.group-middle .src-html::before,
.paragraph-box.group-middle .src-text::before,
.paragraph-box.group-middle .src-joined::before,
.paragraph-box.group-middle .src-replaced::before,
.paragraph-box.group-middle .trans-auto::before,
.paragraph-box.group-middle .trans-text::before {
    border-radius: 0;
    top: 0;
    bottom: 0;
}

/* 下1/4円：endのみ下角丸 */
.paragraph-box.group-end .src-html::before,
.paragraph-box.group-end .src-text::before,
.paragraph-box.group-end .src-joined::before,
.paragraph-box.group-end .src-replaced::before,
.paragraph-box.group-end .trans-auto::before,
.paragraph-box.group-end .trans-text::before {
    border-top-left-radius: 0;
    border-bottom-left-radius: 9px;
    top: 0;
    bottom: 8px;
}

.edit-box .join {
    display: none;
}
.edit-box .join.visible {
    display: block;
    position: absolute;
    top: -10px; /* edit-boxの上に配置 */
    left: 50%;
    transform: translateX(-50%);
    width: 16px;
    height: 16px;
    border-radius: 50%;
    z-index: 10;
}
.edit-box .join.visible::before,
.edit-box .join.visible::after {
    content: "";
    position: absolute;
    background-color: green; /* プラス記号の色 */
    z-index: 11; /* プラス記号を前面に表示 */
}
/* +の横線 */
.edit-box .join.visible::before {
    width: 30px;
    height:10px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* PDFハイライト用のスタイル */
.pdf-highlight-rect {
    position: absolute;
    background-color: rgba(255, 255, 0, 0.5); /* 半透明の黄色 */
    border: 3px solid orange; /* オレンジ色の枠線 */
    mix-blend-mode: multiply; /* 背景と色が混ざるように */
    box-sizing: border-box; /* borderを含めてサイズ計算 */
}
/* +の縦線 */
.edit-box .join.visible::after {
    width: 10px;
    height: 30px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
