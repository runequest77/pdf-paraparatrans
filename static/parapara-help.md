# PDF-ParaParaTrans


# 一覧画面
- `data` フォルダに置かれたPDFファイルの一覧を表示します。
- 詳細画面でパラグラフ抽出を行うと、`data` フォルダに `(PDF名).json` ファイルが作られます。<br>これが `PDF-ParaParaTrans` が使用する `ブックデータ` です。
## help-tooltip
このアプリケーションでは、一部のUI要素にマウスカーソルを合わせると、機能に関する説明がツールチップとして表示されます。
ツールチップの内容は、`static/parapara-help.md` ファイルから取得されています。

## refresh-book-list
PDFリストを最新の状態に更新します。新しいPDFファイルをdataフォルダに追加した場合などにクリックしてください。

## filter-books
タイトルまたはファイル名でPDFリストをフィルタリングします。<br>検索語を入力してボタンをクリックしてください。

## back-to-index
初期画面に戻ります。

## extract-paragraphs
PDFからパラグラフを抽出します。<br>この操作はPDFのサイズによっては時間がかかる場合があります。
- PyMuPdfの「ブロック」を単位としてデータを抽出しています。<br>PDFの作成方法によっては文のつながりがおかしくなったり、表の読み順が崩れたりします。これはPPTでは対策できないのでご容赦ください。
- PDFファイルの一番上のブロックと一番下のブロックからヘッダー/フッタを統計的に求めています。<br>3回以上同位置に同文字列や数値のみブロックが現れるとblock_tagにheader/footerをセットします。

## auto-tagging
抽出されたパラグラフのスタイル(PDFで指定されていたfont-nameとfont-size)に基づいて、荒い判定でタグ付けを行います。

1. **シンボルフォントの判定**:
   - **ルール**: フォントがシンボルフォント（例: Wingdings, Webdings）に該当するスタイルは、`block_tag` を `p`（本文）に設定します。
   - **理由**: シンボルフォントは通常、見出しや重要なテキストではなく、装飾やアイコンとして使用されるためです。

2. **連続出現行数の判定**:
   - **ルール**: 同じスタイルが1ページに4行以上連続して出現するスタイルは、`block_tag` を `p` に設定します。
   - **理由**: 連続した行として出現するスタイルは、本文やリスト項目である可能性が高いと判断します。

3. **文字数の判定**:
   - **ルール**: 100文字以上のパラグラフを持つスタイルは、`block_tag` を `p` に設定します。
   - **理由**: 長いテキストを持つスタイルは本文である可能性が高いと判断します。

4. **章見出し(h1)**:
   - **ルール**: フォントサイズが本文フォントサイズより大きく、1ページに1回だけ出現する場合、`block_tag` を `h1` に設定します。
   - **理由**: PDF-Paraparatransでは `h1` を文書全体のタイトルではなく「章」見出しと考えています。そのため1ページに1回以上出現するスタイルはH3以下としています。

5. **ページ内に3回まで出現する見出し(h3)**:
   - **ルール**: フォントサイズが本文フォントサイズより大きく、1ページに最大3回出現するスタイルは、`block_tag` を `h3` に設定します。
   - **理由**: PDF-Paraparatransでは `h3` を「ページ内に複数出現する見出しの中で最上位」と考えています。<br>自動タグ付けでは `h1` と `h3` の間をあけて、 `h2` にするかどうかの判断ができるようにしています。 

6. **ページ内に4回以上出現する見出し(h5)**:
   - **ルール**: フォントサイズが本文フォントサイズより大きく、1ページに4回以上出現するスタイルは、`block_tag` を `h5` に設定します。
   - **理由**: 頻繁に出現するスタイルは、リストの見出しや小見出しとして使用される可能性があるためです。<br> `h4` と `h6` を空けることで、あとで階層を調整しやすいようにしています。

7. **その他**:
   - **ルール**: 上記のいずれにも該当しない場合、`block_tag` を `p` に設定します。

## join-paragraphs
自動タグ付けされたパラグラフを連結します。

## create-dictionary
抽出・連結されたパラグラフから辞書を作成します。

## translate-dictionary
作成された辞書を翻訳します。（現在非表示）

## replace-all-translations
全ての対訳を辞書に基づいて置換します。

## translate-all-pages
全てのページを翻訳します。この操作は時間がかかる場合があります。

## save-structure
現在の構成をファイルに保存します。（現在非表示）

## export-html
対訳付きのHTMLファイルをエクスポートします。

## reload-book-data
書籍データをリロードします。（現在非表示）

## render-html
HTMLをレンダリングします。（現在非表示）

## toggle-toc-panel
目次パネルの表示/非表示を切り替えます。

## toggle-pdf-panel
PDFパネルの表示/非表示を切り替えます。

## prev-page
前のページに移動します。

## next-page
次のページに移動します。

## translate-page
現在のページを翻訳します。

## toggle-src-html
ソースHTMLの表示/非表示を切り替えます。

## toggle-src-text
原文の表示/非表示を切り替えます。

## toggle-src-joined
連結文の表示/非表示を切り替えます。

## toggle-src-replaced
置換文の表示/非表示を切り替えます。

## toggle-trans-auto
自動翻訳の表示/非表示を切り替えます。

## toggle-trans-text
訳文の表示/非表示を切り替えます。

## open-log
ログウィンドウを開きます。

## open-hotkey-mapper
ホットキーマッパーウィンドウを開きます。

## quick-edit-mode
高速編集モードのオン/オフを切り替えます。

## save-structure-order
構造の順序を保存します。
