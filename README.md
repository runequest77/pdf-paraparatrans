# PDF ParaParaTrans
**英文のPDF** から **パラグラフを解析して段落を抽出** し、原文と訳文を左右で対比させながら翻訳できるツールです。

対訳辞書を使用して、**固有名詞を置換してから自動翻訳**させることができます。

1画面でPDFと下記の5項目を並べて表示し、段落ごとに翻訳済みかどうかのステータスを登録できるため、複雑なレイアウトのPDFの翻訳がストレスなく行えます。
| No | 項目 | 概要 |
| - | ------ | - |
| 1 | HTML | 原文のStyleをタグで持つ文字列。※Style表示未実装なので現時点では効能なし |
| 2 | 原文 | 英文テキスト |
| 3 | 置換文 | 対訳辞書で名詞を置換したテキスト |
| 4 | Auto | 置換文を翻訳APIで翻訳した結果 |
| 5 | 訳文 | 初期値は自動翻訳と同じ。翻訳を整えることができる |


## セットアップ 🛠

ユーザーのニーズによって3種類の使い方を想定しています。
1. ビルド済みexeのダウンロード(初級者向け)
2. ローカルにセットアップ (解る方はこちらでどうぞ)
3. dockerイメージでの利用 (※構築中)

### 1.exeでの利用
1. **[pdf_paraparatrans.exe](https://github.com/runequest77/pdf_paraparatrans/releases) をダウンロード**
2. 実行するフォルダの下に`data`フォルダを作成し、変換したい PDF を入れる。
3. exeを起動すると、黒いコンソールが表示されます。
4. ブラウザで`http://localhost:5000/`にアクセスすると、dataフォルダ内に置いたpdfの一覧が表示されます。
→「使い方」セクションへ！
    > ### ⚠️ 注 意 ⚠️
    > exeでの利用では、初回実行時「Windows によって PC が保護されました」 や 「発行元が不明なアプリ」 の警告が出ます。
    > 
    > ⇒「詳細情報」をクリックして「実行」ボタンを押して起動してください。
    > 
    > 実行ファイルは Python スクリプトを PyInstaller でビルドしたものです。<br>

### 2.ローカルセットアップ
1. pythonがセットアップされ、実行パスが通っている必要があります。
2. リポジトリをpull
3. 依存パッケージのインストール:
    ```
    pip install -r requirements.txt
    ```
4. 直下にdataフォルダを作成し、変換したいPDFを入れる。
5. exeを起動。
    ```
    python app.py
    ```
6. ブラウザで`http://localhost:5000/`にアクセスすると、dataフォルダ内に居れたpdfの一覧が表示されます。
→「使い方」セクションへ！

### 3.dockerイメージでの利用
PyInstallerで作成したexeが使えなかったりローカルセットアップができない方向けにdockerイメージの生成も予定しています。

## 使い方
### google翻訳APIの準備
https://chatgpt.com/share/67d3c05b-cfcc-800b-a8d7-930d470dcb0b

正直ここが一番詰まると思います。
わかりやすく書くのが無理🤣なので、`Chat-GPT` とか `Gemini` とかを頼りに頑張ってください。

`DeepL API` は後日対応予定です。
ローカルでセットアップできる方は　`modules\api_translate.py` を編集することで簡単に他の翻訳APIに差し替えられます。

### 🔠 対訳辞書の準備
`data\trans.csv` に翻訳前に置換したい単語を登録します。

起動時に存在しない場合、サンプルが作成されます。

    ```
    Rune Quest,ルーンクエスト
    RuneQuest,ルーンクエスト
    Glorantha,グローランサ
    ```

    > 現時点で大文字小文字は区別されません。<br>
    > 区別する単語としない単語を指定できるように改善予定です。

### 🅿️ PDF一覧画面
`data`フォルダにいれたPDFが一覧表示されます。PDF名をクリックすると、そのPDF用の画面に移動します。
### 📖 メイン画面

| No | 機能 | 概要 |
| - | - | - |
| 1 | パラグラフ抽出 | PDFを`data`フォルダに居れた後、最初に`1.パラグラフ抽出`をクリックします。確認メッセージでOKを押すと、少し待ち時間があった後にパラグラフが表示されます。 |
| 2 | 全対訳置換 | 対訳辞書 `data/trans.csv` に従って原文を置換した結果を置換文にセットします。 |
| 3 | 全翻訳 | 文書の全ページに対して自動翻訳を実行します。 |
| 4 | ---- | (未実装) |
| 5 | 対訳ファイル出力 | 原文と訳文が横並びになったhtmlファイルを出力します。 |
| 6 | 目次 | <br>h1～h6に指定されたパラグラフを階層表示します。クリックで当該パラグラフに移動します。 |
| 7 | PDF | PDFの現在のページを表示します。<br>チェックボックスで表示/非表示を切り替えられます。 |
| 8 | 順序保存 | パラグラフをドラッグ＆ドロップで並び替えることができます。そのページの並び替えた順序を保存します。 |
| 9 | ページ翻訳 | 現在のページに対して自動翻訳を実行します。|
#### ✍️ パラグラフ
- パラグラフは左端をつかんでドラッグすることで順序が入れ替えられます。
1. 右上のボタン [...] をクリックすると編集画面が開きます。
2. [自動翻訳]をクリックすると、そのパラグラフだけを翻訳できます。
3. [種別]をh1～h6に変更すると、
4. [原文]もしくは[訳文]の項目を編集できます。<br>[保存]で内容が保存され、編集ウィンドウが閉じます。
5. ステータス
    - `〇未翻訳` のパラグラフが「全翻訳」「ページ翻訳」の対象です。
    - `〇自動翻訳` のパラグラフは 対訳辞書の変更によって置換文が変わる場合、「全対訳置換」を行うと`〇未翻訳`に戻ります。
    - `〇下訳`、`〇確定` のパラグラフは「全対訳置換」で置換文は変更されますが、ステータスは変わりません。

## 連絡先
[X(twitter) @nayuta77](https://x.com/nayuta77)
